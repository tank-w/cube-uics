{"remainingRequest":"/Users/apple/www/vue/elmapp/node_modules/babel-loader/lib/index.js!/Users/apple/www/vue/elmapp/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/apple/www/vue/elmapp/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/www/vue/elmapp/node_modules/cube-ui/src/components/upload/upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/www/vue/elmapp/node_modules/cube-ui/src/components/upload/upload.vue","mtime":499162500000},{"path":"/Users/apple/www/vue/elmapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/www/vue/elmapp/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/www/vue/elmapp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/www/vue/elmapp/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3RvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgVXBsb2FkQnRuIGZyb20gJy4vYnRuLnZ1ZSc7CmltcG9ydCBVcGxvYWRGaWxlIGZyb20gJy4vZmlsZS52dWUnOwppbXBvcnQgYWpheFVwbG9hZCBmcm9tICcuL2FqYXgnOwppbXBvcnQgYnRuTWl4aW4gZnJvbSAnLi9idG4tbWl4aW4nOwppbXBvcnQgeyBwcm9jZXNzRmlsZXMsIG5ld0ZpbGUsIFVSTCwgU1RBVFVTX1JFQURZLCBTVEFUVVNfVVBMT0FESU5HLCBTVEFUVVNfRVJST1IsIFNUQVRVU19TVUNDRVNTIH0gZnJvbSAnLi91dGlsJzsKdmFyIENPTVBPTkVOVF9OQU1FID0gJ2N1YmUtdXBsb2FkJzsKdmFyIEVWRU5UX0lOUFVUID0gJ2lucHV0JzsKdmFyIEVWRU5UX0FEREVEID0gJ2ZpbGVzLWFkZGVkJzsKdmFyIEVWRU5UX1NVQk1JVFRFRCA9ICdmaWxlLXN1Ym1pdHRlZCc7CnZhciBFVkVOVF9SRU1PVkVEID0gJ2ZpbGUtcmVtb3ZlZCc7CnZhciBFVkVOVF9TVUNDRVNTID0gJ2ZpbGUtc3VjY2Vzcyc7CnZhciBFVkVOVF9FUlJPUiA9ICdmaWxlLWVycm9yJzsKdmFyIEVWRU5UX0NMSUNLID0gJ2ZpbGUtY2xpY2snOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogQ09NUE9ORU5UX05BTUUsCiAgbWl4aW5zOiBbYnRuTWl4aW5dLAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgYWN0aW9uOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIE9iamVjdF0sCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9LAogICAgbWF4OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMTAKICAgIH0sCiAgICBhdXRvOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBzaW11bHRhbmVvdXNVcGxvYWRzOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMQogICAgfSwKICAgIHByb2Nlc3NGaWxlOiB7CiAgICAgIHR5cGU6IEZ1bmN0aW9uLAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdChmaWxlLCBjYikgewogICAgICAgIGNiKGZpbGUpOwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsZXM6IHRoaXMudmFsdWUsCiAgICAgIHBhdXNlZDogIXRoaXMuYXV0bwogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBhY3Rpb25PcHRpb25zOiBmdW5jdGlvbiBhY3Rpb25PcHRpb25zKCkgewogICAgICB2YXIgYWN0aW9uID0gdGhpcy5hY3Rpb247CgogICAgICBpZiAodHlwZW9mIGFjdGlvbiA9PT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gYWN0aW9uID8gewogICAgICAgICAgdGFyZ2V0OiBhY3Rpb24KICAgICAgICB9IDogbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYWN0aW9uOwogICAgICB9CiAgICB9LAogICAgaXNTaG93QnRuOiBmdW5jdGlvbiBpc1Nob3dCdG4oKSB7CiAgICAgIHJldHVybiB0aGlzLmZpbGVzLmxlbmd0aCA8IHRoaXMubWF4OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShuZXdWYWwpIHsKICAgICAgdGhpcy5maWxlcyA9IG5ld1ZhbDsKICAgIH0sCiAgICBmaWxlczogZnVuY3Rpb24gZmlsZXMobmV3RmlsZXMpIHsKICAgICAgdGhpcy4kZW1pdChFVkVOVF9JTlBVVCwgbmV3RmlsZXMpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYWRkRmlsZXM6IGZ1bmN0aW9uIGFkZEZpbGVzKGZpbGVzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiRlbWl0KEVWRU5UX0FEREVELCBmaWxlcyk7CiAgICAgIHZhciBmaWxlc0xlbiA9IHRoaXMuZmlsZXMubGVuZ3RoOwogICAgICB2YXIgbmV3RmlsZXMgPSBbXTsKICAgICAgdmFyIG1heExlbiA9IHRoaXMubWF4IC0gZmlsZXNMZW47CiAgICAgIHZhciBpID0gMDsKICAgICAgdmFyIGZpbGUgPSBmaWxlc1tpXTsKCiAgICAgIHdoaWxlIChuZXdGaWxlcy5sZW5ndGggPCBtYXhMZW4gJiYgZmlsZSkgewogICAgICAgIGlmICghZmlsZS5pZ25vcmUpIHsKICAgICAgICAgIG5ld0ZpbGVzLnB1c2goZmlsZSk7CiAgICAgICAgICB0aGlzLmZpbGVzLnB1c2gobmV3RmlsZSgpKTsKICAgICAgICB9CgogICAgICAgIGZpbGUgPSBmaWxlc1srK2ldOwogICAgICB9CgogICAgICBwcm9jZXNzRmlsZXMobmV3RmlsZXMsIHRoaXMucHJvY2Vzc0ZpbGUsIGZ1bmN0aW9uIChmaWxlLCBpbmRleCkgewogICAgICAgIF90aGlzLiRzZXQoX3RoaXMuZmlsZXMsIGZpbGVzTGVuICsgaW5kZXgsIGZpbGUpOwoKICAgICAgICBfdGhpcy4kZW1pdChFVkVOVF9TVUJNSVRURUQsIGZpbGUpOwogICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gd2FpdGluZyB1aQogICAgICAgIF90aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy51cGxvYWQoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgcmVtb3ZlRmlsZTogZnVuY3Rpb24gcmVtb3ZlRmlsZShmaWxlKSB7CiAgICAgIHRoaXMuJGVtaXQoRVZFTlRfUkVNT1ZFRCwgZmlsZSk7CiAgICAgIGZpbGUuX3hociAmJiBmaWxlLl94aHIuYWJvcnQoKTsKCiAgICAgIGlmIChmaWxlLnVybCkgewogICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoZmlsZS51cmwpOwogICAgICB9CgogICAgICB2YXIgaW5kZXggPSB0aGlzLmZpbGVzLmluZGV4T2YoZmlsZSk7CiAgICAgIHRoaXMuZmlsZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy51cGxvYWQoKTsKICAgIH0sCiAgICBmaWxlQ2xpY2s6IGZ1bmN0aW9uIGZpbGVDbGljayhmaWxlKSB7CiAgICAgIHRoaXMuJGVtaXQoRVZFTlRfQ0xJQ0ssIGZpbGUpOwogICAgfSwKICAgIHVwbG9hZDogZnVuY3Rpb24gdXBsb2FkKHJldHJ5KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmFjdGlvbk9wdGlvbnM7CgogICAgICBpZiAodGhpcy5wYXVzZWQgfHwgIW9wdGlvbnMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBsZW4gPSB0aGlzLmZpbGVzLmxlbmd0aDsKICAgICAgdmFyIHVwbG9hZGluZ0NvdW50ID0gMDsKICAgICAgdmFyIGkgPSAwOwoKICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgICAgdmFyIGZpbGUgPSBfdGhpczIuZmlsZXNbaV07CiAgICAgICAgdmFyIHN0YXR1cyA9IGZpbGUuc3RhdHVzOwoKICAgICAgICBpZiAoc3RhdHVzID09PSBTVEFUVVNfUkVBRFkgfHwgcmV0cnkgJiYgc3RhdHVzID09PSBTVEFUVVNfRVJST1IgJiYgZmlsZS5fcmV0cnlJZCAhPT0gX3RoaXMyLnJldHJ5SWQpIHsKICAgICAgICAgIGFqYXhVcGxvYWQoZmlsZSwgb3B0aW9ucywgZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gU1RBVFVTX0VSUk9SKSB7CiAgICAgICAgICAgICAgZmlsZS5fcmV0cnlJZCA9IF90aGlzMi5yZXRyeUlkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczIuJGVtaXQoZmlsZS5zdGF0dXMgPT09IFNUQVRVU19TVUNDRVNTID8gRVZFTlRfU1VDQ0VTUyA6IEVWRU5UX0VSUk9SLCBmaWxlKTsKCiAgICAgICAgICAgIF90aGlzMi51cGxvYWQocmV0cnkpOwogICAgICAgICAgfSk7CiAgICAgICAgICB1cGxvYWRpbmdDb3VudCsrOwogICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSBTVEFUVVNfVVBMT0FESU5HKSB7CiAgICAgICAgICB1cGxvYWRpbmdDb3VudCsrOwogICAgICAgIH0KCiAgICAgICAgaSsrOwogICAgICB9OwoKICAgICAgd2hpbGUgKGkgPCBsZW4gJiYgdXBsb2FkaW5nQ291bnQgPCB0aGlzLnNpbXVsdGFuZW91c1VwbG9hZHMpIHsKICAgICAgICBfbG9vcCgpOwogICAgICB9CiAgICB9LAogICAgc3RhcnQ6IGZ1bmN0aW9uIHN0YXJ0KCkgewogICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlOwogICAgICB0aGlzLnVwbG9hZCgpOwogICAgfSwKICAgIHBhdXNlOiBmdW5jdGlvbiBwYXVzZSgpIHsKICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlOwogICAgICB0aGlzLmZpbGVzLmZvckVhY2goZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICBpZiAoZmlsZS5zdGF0dXMgPT09IFNUQVRVU19VUExPQURJTkcpIHsKICAgICAgICAgIGZpbGUuX3hoci5hYm9ydCgpOwoKICAgICAgICAgIGZpbGUuc3RhdHVzID0gU1RBVFVTX1JFQURZOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgcmV0cnk6IGZ1bmN0aW9uIHJldHJ5KCkgewogICAgICB0aGlzLnJldHJ5SWQgPSBEYXRlLm5vdygpOwogICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlOwogICAgICB0aGlzLnVwbG9hZCh0cnVlKTsKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIFVwbG9hZEJ0bjogVXBsb2FkQnRuLAogICAgVXBsb2FkRmlsZTogVXBsb2FkRmlsZQogIH0KfTs="},{"version":3,"sources":["upload.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"cube-upload\">\n    <slot>\n      <div class=\"cube-upload-def clear-fix\">\n        <upload-file v-for=\"(file, i) in files\" :file=\"file\" :key=\"i\" @click=\"fileClick\"></upload-file>\n        <upload-btn :multiple=\"multiple\" :accept=\"accept\" v-show=\"isShowBtn\"></upload-btn>\n      </div>\n    </slot>\n  </div>\n</template>\n<script type=\"text/ecmascript-6\">\n  import UploadBtn from './btn.vue'\n  import UploadFile from './file.vue'\n  import ajaxUpload from './ajax'\n  import btnMixin from './btn-mixin'\n  import {\n    processFiles,\n    newFile,\n    URL,\n    STATUS_READY,\n    STATUS_UPLOADING,\n    STATUS_ERROR,\n    STATUS_SUCCESS\n  } from './util'\n\n  const COMPONENT_NAME = 'cube-upload'\n  const EVENT_INPUT = 'input'\n  const EVENT_ADDED = 'files-added'\n  const EVENT_SUBMITTED = 'file-submitted'\n  const EVENT_REMOVED = 'file-removed'\n  const EVENT_SUCCESS = 'file-success'\n  const EVENT_ERROR = 'file-error'\n  const EVENT_CLICK = 'file-click'\n\n  export default {\n    name: COMPONENT_NAME,\n    mixins: [btnMixin],\n    props: {\n      value: {\n        type: Array,\n        default() {\n          return []\n        }\n      },\n      action: {\n        type: [String, Object],\n        default: ''\n      },\n      max: {\n        type: Number,\n        default: 10\n      },\n      auto: {\n        type: Boolean,\n        default: true\n      },\n      simultaneousUploads: {\n        type: Number,\n        default: 1\n      },\n      processFile: {\n        type: Function,\n        default: function (file, cb) {\n          cb(file)\n        }\n      }\n    },\n    data() {\n      return {\n        files: this.value,\n        paused: !this.auto\n      }\n    },\n    computed: {\n      actionOptions() {\n        const action = this.action\n        if (typeof action === 'string') {\n          return action ? {\n            target: action\n          } : null\n        } else {\n          return action\n        }\n      },\n      isShowBtn() {\n        return this.files.length < this.max\n      }\n    },\n    watch: {\n      value(newVal) {\n        this.files = newVal\n      },\n      files(newFiles) {\n        this.$emit(EVENT_INPUT, newFiles)\n      }\n    },\n    methods: {\n      addFiles(files) {\n        this.$emit(EVENT_ADDED, files)\n        const filesLen = this.files.length\n        const newFiles = []\n        const maxLen = this.max - filesLen\n        let i = 0\n        let file = files[i]\n        while (newFiles.length < maxLen && file) {\n          if (!file.ignore) {\n            newFiles.push(file)\n            this.files.push(newFile())\n          }\n          file = files[++i]\n        }\n        processFiles(newFiles, this.processFile, (file, index) => {\n          this.$set(this.files, filesLen + index, file)\n          this.$emit(EVENT_SUBMITTED, file)\n        }, () => {\n          // waiting ui\n          this.$nextTick(() => {\n            this.upload()\n          })\n        })\n      },\n      removeFile(file) {\n        this.$emit(EVENT_REMOVED, file)\n        file._xhr && file._xhr.abort()\n        if (file.url) {\n          URL.revokeObjectURL(file.url)\n        }\n        const index = this.files.indexOf(file)\n        this.files.splice(index, 1)\n        this.upload()\n      },\n      fileClick(file) {\n        this.$emit(EVENT_CLICK, file)\n      },\n      upload(retry) {\n        const options = this.actionOptions\n        if (this.paused || !options) {\n          return\n        }\n        const len = this.files.length\n        let uploadingCount = 0\n        let i = 0\n        while (i < len && uploadingCount < this.simultaneousUploads) {\n          const file = this.files[i]\n          const status = file.status\n          if (status === STATUS_READY || (retry && status === STATUS_ERROR && file._retryId !== this.retryId)) {\n            ajaxUpload(file, options, (file) => {\n              if (status === STATUS_ERROR) {\n                file._retryId = this.retryId\n              }\n              this.$emit(file.status === STATUS_SUCCESS ? EVENT_SUCCESS : EVENT_ERROR, file)\n              this.upload(retry)\n            })\n            uploadingCount++\n          } else if (status === STATUS_UPLOADING) {\n            uploadingCount++\n          }\n          i++\n        }\n      },\n      start() {\n        this.paused = false\n        this.upload()\n      },\n      pause() {\n        this.paused = true\n        this.files.forEach((file) => {\n          if (file.status === STATUS_UPLOADING) {\n            file._xhr.abort()\n            file.status = STATUS_READY\n          }\n        })\n      },\n      retry() {\n        this.retryId = Date.now()\n        this.paused = false\n        this.upload(true)\n      }\n    },\n    components: {\n      UploadBtn,\n      UploadFile\n    }\n  }\n</script>\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n  .cube-upload\n    position: relative\n\n  .cube-upload-def\n    margin-right: -10px\n    .cube-upload-btn, .cube-upload-file\n      float: left\n      margin: 0 10px 10px 0\n</style>\n"],"sourceRoot":"node_modules/cube-ui/src/components/upload"}]}